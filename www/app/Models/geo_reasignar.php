<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

/**
 * @property int $id_geo_reasignar
 * @property string $esquema
 * @property string $tabla
 * @property string $campo
 */
class geo_reasignar extends Model
{
    /**
     * The table associated with the model.
     * 
     * @var string
     */
    protected $table = 'catalogos.geo_reasignar';

    /**
     * The primary key for the model.
     * 
     * @var string
     */
    protected $primaryKey = 'id_geo_reasignar';

    /**
     * @var array
     */
    protected $fillable = ['esquema', 'tabla', 'campo'];

    /**
     * Indicates if the model should be timestamped.
     * 
     * @var bool
     */
    public $timestamps = false;

    /**
     * The storage format of the model's date columns.
     * 
     * @var string
     */
    protected $dateFormat = 'U';


    //Corride el 23-abr-2021 para corregir ingresos manuales duplicados
    public static function reasingar_internacional() {
        $geo =array();
        $geo[38961]=9180;
        $geo[39223]=9218;
        $geo[39233]=39231;
        $geo[39232]=39231;
        $geo[37670]=9218;
        $geo[39155]=9180;
        $geo[39169]=9180;
        $geo[38974]=38973;
        $geo[39177]=9180;
        $geo[38068]=38067;
        $geo[37691]=37690;
        $geo[39065]=39064;
        $geo[37625]=37617;
        $geo[39225]=39224;
        $geo[37624]=37621;
        $geo[37699]=9920;
        $geo[39163]=9188;
        $geo[39220]=9221;
        $geo[39221]=9221;
        $geo[39265]=9212;
        $geo[39170]=9212;
        $geo[39273]=9211;
        $geo[39204]=39201;
        $geo[39010]=38713;
        $total=0;
        foreach($geo as $viejo=>$nuevo) {
           $conteo = geo::reasignar($viejo,$nuevo);
           if(is_numeric($conteo)) {
               $total+=$conteo;
           }
           else {
               echo $conteo.PHP_EOL;
           }


        }
        return $total;


    }


    //Corrido el 23-abr-2021 para corregir ingresos manuales duplicados
    public static function reasingar_nacional() {
        $geo =array();
        $geo[37876]=1038;
        $geo[38070]=459;
        $geo[37748]=37747;
        $geo[39123]=39122;
        $geo[37811]=37805;
        $geo[38989]=37761;
        $geo[37650]=37649;
        $geo[37826]=37825;
        $geo[38056]=38053;
        $geo[38054]=38053;
        $geo[37838]=37833;
        $geo[37837]=37833;
        $geo[37834]=37833;
        $geo[37832]=37806;
        $geo[37807]=37806;
        $geo[38994]=38993;
        $geo[39116]=39048;
        $geo[39063]=39058;
        $geo[39059]=39058;
        $geo[38033]=38032;
        $geo[39086]=38076;
        $geo[39082]=38076;
        $geo[39127]=39119;
        $geo[38012]=38004;
        $geo[37615]=37611;
        $geo[37710]=397;
        $geo[37707]=397;
        $geo[39036]=184;
        $geo[37708]=428;
        $geo[37709]=428;
        $geo[37711]=751;
        $geo[37792]=37789;
        $geo[37790]=37789;
        $geo[39129]=39128;
        $geo[39130]=39128;
        $geo[39131]=39128;
        $geo[37871]=37870;
        $geo[37872]=37870;
        $geo[37642]=37862;
        $geo[38013]=38008;
        $geo[39091]=39090;
        $geo[39110]=39109;
        $geo[37753]=37752;
        $geo[37797]=36;
        $geo[37598]=37597;
        $geo[37829]=37828;
        $geo[37813]=37812;
        $geo[38064]=38063;
        $geo[37614]=37613;
        $geo[39111]=39108;
        $geo[39113]=39108;
        $geo[39115]=39108;
        $geo[39248]=38981;
        $geo[39089]=39087;
        $geo[38066]=459;
        $geo[39072]=36;
        $geo[37910]=417;
        $geo[37911]=417;
        $geo[37912]=417;
        $geo[37628]=415;
        $geo[37967]=1039;
        $geo[38041]=185;
        $geo[38982]=1041;
        $geo[37600]=881;
        $geo[37661]=36;
        $geo[37663]=36;
        $geo[37662]=106;
        $geo[37693]=150;
        $geo[37694]=150;
        $geo[37593]=556;
        $geo[37594]=596;
        $geo[37896]=692;
        $geo[37743]=434;
        $geo[37744]=434;
        $geo[37651]=867;
        $geo[37652]=867;
        $geo[37644]=867;
        $geo[39041]=813;
        $geo[39071]=36;
        $geo[39040]=751;
        $geo[37657]=867;
        $geo[39038]=800;
        $geo[39068]=423;
        $geo[39070]=36;
        $geo[37658]=36;
        $geo[38972]=231;
        $geo[38966]=820;
        $geo[37830]=881;
        $geo[38963]=1047;
        $geo[38074]=141;
        $geo[37601]=698;
        $geo[39121]=39120;
        $geo[39012]=39011;
        $geo[37906]=37905;
        $geo[37987]=37986;
        $geo[38028]=38027;
        $geo[37920]=37919;
        $geo[37921]=37919;
        //
        $geo[37664]=1041;
        $geo[37854]=184;
        $geo[37819]=354;
        $geo[37859]=393;
        $geo[37820]=397;
        $geo[37815]=722;
        $geo[37821]=1041;
        $geo[37849]=1041;
        $geo[37713]=1059;
        $geo[37677]=1109;
        $geo[37676]=1110;
        $geo[37897]=692;
        $geo[37880]=887;
        $geo[37889]=517;
        $total=0;
        foreach($geo as $viejo=>$nuevo) {
            $conteo = geo::reasignar($viejo,$nuevo);
            if(is_numeric($conteo)) {
                $total+=$conteo;
            }
            else {
                echo $conteo.PHP_EOL;
            }
        }
        return $total;
    }


    //Corrido el 4-may-2021 para corregir ingresos manuales invÃ¡lidos, de acuerdo a correo del equipo de geportal
    public static function reasignar_a_municipio() {
        $geo =array();
        $geo[37951]=1134;

        $geo[38949]=1126;











        $geo[37881]=132;










        $geo[39092]=71;
























        $geo[37928]=384;




        $geo[39003]=624;
        $geo[38022]=491;

        $geo[37622]=494;
        $geo[38053]=580;
        $geo[37623]=609;
        $geo[39061]=508;
        $geo[37608]=543;

        $geo[38052]=1136;
        $geo[37931]=1136;






        $geo[39043]=679;









        $geo[39119]=812;
        $geo[39109]=812;
        $geo[37831]=800;


        $geo[39108]=812;
        $geo[39120]=812;

        $geo[37937]=796;

        $geo[39117]=812;






        $geo[37851]=815;
        $geo[37641]=848;



        $geo[37760]=1113;







        $geo[37595]=881;
        $geo[38959]=913;
        $geo[38977]=954;





        $geo[37979]=1057;





        $geo[37660]=1067;








        $geo[37692]=1073;

        $geo[39149]=1048;


        $geo[37982]=1071;





        $geo[37985]=1054;

        $geo[37638]=1047;


        $geo[37758]=1071;








        $geo[39067]=1072;







        $geo[37864]=1054;
        $geo[37632]=1063;
        $geo[38985]=1041;


        $geo[37958]=1134;
        $geo[37984]=1134;
        $geo[37894]=1129;
        $geo[37940]=1133;
        $geo[37946]=1129;
        $geo[39099]=1130;
        $geo[38026]=1129;
        $geo[37956]=1131;
        $geo[37893]=1127;
        $geo[37952]=1127;
        $geo[37949]=1127;
        $geo[38004]=1133;
        $geo[37997]=1133;
        $geo[39054]=1127;
        $geo[37850]=1127;
        $geo[37954]=1126;
        $geo[37947]=1129;
        $geo[37948]=1125;
        $geo[37945]=1131;
        $geo[38996]=1126;
        $geo[37973]=1126;
        $geo[38031]=1125;
        $geo[39103]=1134;
        $geo[37955]=1134;
        $geo[37953]=1134;
        $geo[38018]=1130;
        $geo[39050]=1129;
        $geo[37986]=1134;
        $geo[38030]=1125;
        $geo[38038]=1125;
        $geo[37961]=1130;
        $geo[38043]=1125;
        $geo[37950]=1134;
        $geo[38045]=1125;
        $geo[37929]=1125;
        $geo[37924]=1125;
        $geo[39060]=1125;
        $geo[39094]=48;
        $geo[37732]=132;
        $geo[37724]=77;
        $geo[37734]=107;
        $geo[37884]=70;
        $geo[37653]=48;
        $geo[37655]=48;
        $geo[37656]=150;




        $geo[37957]=140;
        $geo[37733]=107;
        $geo[39088]=71;
        $geo[38075]=77;


        $geo[37672]=77;
        $geo[39090]=71;
        $geo[39025]=36;
        $geo[37712]=77;
        $geo[37648]=48;
        $geo[39167]=60;
        $geo[39102]=73;
        $geo[39148]=60;
        $geo[39018]=129;
        $geo[39017]=150;
        $geo[39093]=48;
        $geo[37839]=117;



        $geo[37861]=148;
        $geo[37735]=132;
        $geo[37766]=150;
        $geo[37729]=116;
        $geo[39009]=133;

        $geo[37717]=168;


        $geo[38057]=184;
        $geo[37725]=184;
        $geo[38036]=184;
        $geo[37939]=197;


        $geo[37789]=211;
        $geo[39095]=208;
        $geo[37613]=189;
        $geo[37810]=186;
        $geo[39053]=197;
        $geo[37874]=273;
        $geo[37867]=257;
        $geo[37702]=304;
        $geo[37727]=304;
        $geo[37868]=257;
        $geo[37963]=277;
        $geo[38980]=354;
        $geo[39023]=381;
        $geo[37875]=381;
        $geo[37942]=385;
        $geo[37841]=389;
        $geo[39069]=381;
        $geo[37804]=394;
        $geo[37778]=384;
        $geo[37784]=394;
        $geo[37974]=383;
        $geo[37645]=389;
        $geo[37800]=394;
        $geo[37960]=1090;
        $geo[38046]=1107;
        $geo[38032]=1092;
        $geo[37786]=397;
        $geo[37902]=406;
        $geo[39033]=410;
        $geo[39073]=435;
        $geo[38021]=433;
        $geo[37852]=402;
        $geo[39133]=406;
        $geo[37630]=415;
        $geo[37846]=397;
        $geo[37629]=415;


        $geo[37857]=457;
        $geo[39028]=454;
        $geo[37750]=439;
        $geo[37752]=439;
        $geo[38069]=459;
        $geo[37751]=439;
        $geo[37759]=454;
        $geo[37788]=448;
        $geo[37847]=612;
        $geo[37938]=624;
        $geo[38071]=634;
        $geo[38072]=634;
        $geo[38048]=615;
        $geo[37726]=619;
        $geo[37730]=634;
        $geo[37992]=634;
        $geo[38047]=625;
        $geo[37994]=634;
        $geo[37808]=624;
        $geo[39030]=638;
        $geo[38010]=489;
        $geo[37999]=464;

        $geo[38954]=468;
        $geo[37731]=467;
        $geo[38055]=580;
        $geo[37738]=560;
        $geo[37918]=519;

        $geo[37899]=1144;
        $geo[37836]=1144;
        $geo[37892]=1144;
        $geo[37840]=1144;
        $geo[37803]=1147;
        $geo[37714]=1147;
        $geo[37773]=1147;
        $geo[38058]=646;
        $geo[37904]=648;
        $geo[37848]=646;
        $geo[37903]=648;
        $geo[38059]=647;
        $geo[37791]=677;
        $geo[39047]=679;
        $geo[39055]=678;
        $geo[37667]=677;
        $geo[37793]=677;
        $geo[37799]=683;
        $geo[37776]=678;
        $geo[39057]=679;
        $geo[39029]=690;
        $geo[37814]=683;
        $geo[37771]=710;
        $geo[37602]=718;
        $geo[37596]=709;
        $geo[37798]=710;
        $geo[38956]=710;
        $geo[37828]=712;
        $geo[37845]=718;
        $geo[37936]=710;
        $geo[37794]=694;
        $geo[37891]=710;
        $geo[37816]=692;
        $geo[37768]=692;
        $geo[38993]=733;
        $geo[39048]=749;
        $geo[37883]=735;
        $geo[38009]=733;
        $geo[37879]=750;
        $geo[39049]=748;
        $geo[37866]=740;
        $geo[39001]=767;
        $geo[37747]=812;
        $geo[39122]=812;
        $geo[39000]=812;
        $geo[39140]=801;
        $geo[37787]=785;
        $geo[39114]=812;
        $geo[39128]=801;
        $geo[37827]=812;
        $geo[37873]=769;
        $geo[37853]=769;
        $geo[37757]=769;
        $geo[39132]=788;
        $geo[38952]=811;
        $geo[37934]=767;
        $geo[37886]=765;
        $geo[37917]=788;
        $geo[37885]=812;
        $geo[37865]=794;
        $geo[37932]=789;
        $geo[39126]=812;
        $geo[37933]=784;
        $geo[37769]=1111;
        $geo[37855]=1115;
        $geo[37922]=1112;
        $geo[39074]=1114;
        $geo[37754]=1111;
        $geo[38017]=1113;
        $geo[39096]=1120;
        $geo[37779]=1110;
        $geo[37626]=859;
        $geo[37599]=867;
        $geo[39002]=900;
        $geo[37605]=889;
        $geo[39020]=928;
        $geo[39022]=928;
        $geo[37856]=900;
        $geo[37870]=900;
        $geo[37767]=900;
        $geo[37604]=900;
        $geo[39011]=901;
        $geo[37993]=983;
        $geo[37878]=976;
        $geo[37914]=971;
        $geo[37915]=1023;
        $geo[37926]=1000;
        $geo[38001]=994;
        $geo[37772]=1017;
        $geo[39104]=1062;
        $geo[38002]=1079;
        $geo[39107]=1062;
        $geo[39037]=1072;
        $geo[37927]=1075;
        $geo[37680]=1047;
        $geo[37681]=1054;
        $geo[37862]=1067;
        $geo[39154]=1041;
        $geo[39106]=1072;
        $geo[37640]=1043;
        $geo[37637]=1043;
        $geo[38005]=1049;
        $geo[37971]=1043;
        $geo[37988]=1054;
        $geo[37905]=1041;
        $geo[39066]=1076;
        $geo[37636]=1070;
        $geo[37745]=1148;
        $geo[37900]=1149;

        $total=0;
        $error=0;
        foreach($geo as $viejo=>$nuevo) {
            $conteo = geo::reasignar($viejo,$nuevo);
            if(is_numeric($conteo)) {
                $total+=$conteo;
            }
            else {
                $error++;
                echo $conteo.PHP_EOL;
            }
        }
        $conteo=count($geo);
        return "Criterios:$conteo. Sustituciones: $total. No aplicados:$error" ;
    }

}
